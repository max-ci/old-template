!function($){$.fn.jflatTimeline=function(e){var n=new Array,t=function(e,n){return e>n?-1:n>e?1:0},a=0,r=0,i=2,d=0,l=500,c=new Array;c[0]="Jan.",c[1]="Feb.",c[2]="Mar.",c[3]="Apr.",c[4]="May.",c[5]="Jun.",c[6]="Jul.",c[7]="Aug.",c[8]="Sep.",c[9]="Oct.",c[10]="Nov.",c[11]="Dec.";var h={};return e&&$.extend(h,e),this.each(function(){var e=$(this);h.scroll&&(i=parseInt(h.scroll)),h.width&&e.css("width",h.width),h.scrollingTime&&(l=h.scrollingTime),e.children(".timeline-wrap").children(".event.selected").length||e.children(".timeline-wrap").children(".event:first-child").addClass("selected"),a=new Date(e.children(".timeline-wrap").children(".event.selected").attr("data-date")).getFullYear(),r=new Date(e.children(".timeline-wrap").children(".event.selected").attr("data-date")).getMonth(),e.children(".month-year-bar").length||(e.prepend('<div class = "month-year-bar"></div>'),e.children(".month-year-bar").prepend('<div class = "year"><a class = "prev"><i class="fa fa-angle-left"></i></a><span>'+String(a)+'</span><a class="next"><i class ="fa fa-angle-right"></i></a></div>'),e.children(".month-year-bar").prepend('<div class = "month"><a class = "prev"><i class="fa fa-angle-left"></i></a><span>'+String(c[r])+'</span><a class = "next"><i class="fa fa-angle-right"></i></a></div>'));var s=0;for(e.children(".timeline-wrap").children(".event").each(function(){n[s]=new Date($(this).attr("data-date")),s++}),n.sort(t),e.children(".dates-bar").length||e.children(".month-year-bar").after('<div class = "dates-bar"><a class = "prev"><i class ="fa fa-angle-left"></i></a><a class="noevent">No event found</a><a class = "next"><i class="fa fa-angle-right"></i></a></div>'),s=0;s<n.length;s++)dateString=String(n[s].getMonth()+1+"/"+n[s].getDate()+"/"+n[s].getFullYear()),e.children(".dates-bar").children('a[data-date = "'+dateString+'"]').length||e.children(".dates-bar").children("a.prev").after("<a data-date = "+dateString+'><span class = "date">'+String(n[s].getDate())+'</span><span class = "month">'+String(c[n[s].getMonth()])+"</span></a>");for(s=0;s<e.children(".timeline-wrap").children(".event").length;s++){var o=new Date(e.children(".timeline-wrap").children(".event:nth-child("+String(s+1)+")").attr("data-date"));dateString=String(o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear()),e.children(".timeline-wrap").children(".event:nth-child("+String(s+1)+")").attr("data-date",dateString)}return e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").each(function(){new Date($(this).attr("data-date")).getFullYear()!=a&&$(this).hide()}),e.hasClass("calledOnce")?0:(e.addClass("calledOnce"),e.children(".dates-bar").children('a[data-date ="'+String(e.children(".timeline-wrap").children(".event.selected").attr("data-date"))+'"]').addClass("selected"),e.width()<500&&e.addClass("s_screen"),$(window).resize(function(){e.width()<500?e.addClass("s_screen"):e.removeClass("s_screen")}),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").click(function(){o=String($(this).attr("data-date")),e.children(".timeline-wrap").children(".event.selected").removeClass("selected"),e.children(".timeline-wrap").children('.event[data-date="'+o+'"]').addClass("selected"),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").removeClass("selected"),$(this).addClass("selected")}),e.children(".dates-bar").children("a.next").click(function(){var n=i,t=e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible()").length;if(d+i>=t&&(n=t-d-1),parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"))*n>e.children(".dates-bar").width())for(;parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"))*n>e.children(".dates-bar").width()&&n>1;)n-=1;var a=-1*n*parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"));e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").animate({marginLeft:"+="+String(a)+"px"},l),d+=n,r=new Date(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq("+String(d)+")").attr("data-date")).getMonth(),e.children(".month-year-bar").children(".month").children("span").text(c[r])}),e.children(".dates-bar").children("a.prev").click(function(){var n=i,t=e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible()").length;if(i>=d&&(n=d),parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"))*n>e.children(".dates-bar").width())for(;parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"))*n>e.children(".dates-bar").width()&&n>1;)n-=1;var a=n*parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"));e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").animate({marginLeft:"+="+String(a)+"px"},l),d-=n,r=new Date(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq("+String(d)+")").attr("data-date")).getMonth(),e.children(".month-year-bar").children(".month").children("span").text(c[r])}),e.children(".month-year-bar").children(".month").children(".next").click(function(){11!=r?r+=1:r=0;var n=0;e.children(".month-year-bar").children(".month").children("span").text(c[r]),e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible()").each(function(){return n+=1,new Date($(this).attr("data-date")).getMonth()>=r?!1:void 0});var t=(n-d-1)*parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"));e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").animate({marginLeft:"-="+String(t)+"px"},l),d=n-1}),e.children(".month-year-bar").children(".month").children(".prev").click(function(){0!=r?r-=1:r=11;var n=0;e.children(".month-year-bar").children(".month").children("span").text(c[r]),e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible()").each(function(){return n+=1,new Date($(this).attr("data-date")).getMonth()>=r?!1:void 0});var t=(n-d-1)*parseInt(e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").css("width"));e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible():eq(0)").animate({marginLeft:"-="+String(t)+"px"},l),d=n-1}),e.children(".month-year-bar").children(".year").children(".next").click(function(){a+=1,e.children(".month-year-bar").children(".year").children("span").text(String(a)),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").each(function(){new Date($(this).attr("data-date")).getFullYear()!=a?$(this).hide():$(this).show()}),e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible").length?(e.children(".dates-bar").children("a.noevent").css("display","none"),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").css("margin-left","0"),d=0,e.children(".timeline-wrap").children(".event").removeClass("selected"),e.children(".timeline-wrap").children(".event").each(function(){return o=new Date($(this).attr("data-date")),o.getFullYear()==a?($(this).addClass("selected"),r=o.getMonth(),e.children(".month-year-bar").children(".month").children("span").text(c[r]),!1):void 0})):e.children(".dates-bar").children("a.noevent").css("display","block"),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").removeClass("selected"),e.children(".dates-bar").children('a[data-date ="'+String(e.children(".timeline-wrap").children(".event.selected").attr("data-date"))+'"]').addClass("selected")}),void e.children(".month-year-bar").children(".year").children(".prev").click(function(){a-=1,e.children(".month-year-bar").children(".year").children("span").text(String(a)),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").each(function(){new Date($(this).attr("data-date")).getFullYear()!=a?$(this).hide():$(this).show()}),e.children(".dates-bar").children("a:not(.prev, .next, .noevent):visible").length?(e.children(".dates-bar").children("a.noevent").css("display","none"),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").css("margin-left","0"),d=0,e.children(".timeline-wrap").children(".event").removeClass("selected"),e.children(".timeline-wrap").children(".event").each(function(){return o=new Date($(this).attr("data-date")),o.getFullYear()==a?($(this).addClass("selected"),r=o.getMonth(),e.children(".month-year-bar").children(".month").children("span").text(c[r]),!1):void 0})):e.children(".dates-bar").children("a.noevent").css("display","block"),e.children(".dates-bar").children("a:not(.prev, .next, .noevent)").removeClass("selected"),e.children(".dates-bar").children('a[data-date ="'+String(e.children(".timeline-wrap").children(".event.selected").attr("data-date"))+'"]').addClass("selected")}))})}}(jQuery);